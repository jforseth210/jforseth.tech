<!DOCTYPE html>
<html lang="en">

<head>
  <!--Clicky Web Analytics-->
  <script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101163615);</script>
  <script async src="//static.getclicky.com/js"></script>
  <!--End Clicky Web Analytics-->
  <meta charset="UTF-8">
  <title>{{name}}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    href="https://fonts.googleapis.com/css?family=Baskervville|Calistoga|Gupter|Merriweather|Playfair+Display|Roboto+Condensed|Roboto+Mono|Roboto+Slab|Source+Sans+Pro&display=swap"
    rel="stylesheet">

  <link rel='stylesheet' href='/static/index.css' type='text/css' />
  <link href="https://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
  <script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote.js"></script>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type">
  <style>
    html{
      background-color: #ffffff !important;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      -webkit-transition: .4s;
      transition: .4s;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      -webkit-transition: .4s;
      transition: .4s;
    }

    input:checked+.slider {
      background-color: #2196F3;
    }

    input:focus+.slider {
      box-shadow: 0 0 1px #2196F3;
    }

    input:checked+.slider:before {
      -webkit-transform: translateX(26px);
      -ms-transform: translateX(26px);
      transform: translateX(26px);
    }
  </style>
</head>

<body>
  <!--Offline alert-->
    <div id=offlineAlert class="alert warning" style="display: none;">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
        Whoops! You're offline. Connect to the internet to make sure your changes get saved. (Or copy-paste it somewhere safe.)
    </div>
    <div id=onlineAlert class="alert success" style="display: none;">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
        Back online! Make sure you save your changes. 
    </div>
  <p>Autosave:</p>
  <label class="switch">
    <input type="checkbox" id="autoSave" onclick="autoSaveToggle();" checked >
    <span class="slider round"></span>
  </label>
  <button type="submit" id=saveBtn form="form" value="Save">Save</button>
  <form id=form method="post" action="/writer/save/{{name}}">
    <textarea id="summernote" name="editordata"></textarea>
  </form>
  <script>
    function updateOnlineStatus(event){
      if(navigator.onLine){
        document.getElementById("onlineAlert").style.display="block";
      } else {
        document.getElementById("offlineAlert").style.display="block";
      }
    }
    window.addEventListener('online',  updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);
    function autoSaveToggle(){
      if (document.getElementById("autoSave").checked){
        document.getElementById("saveBtn").style.display="none";
      } else {
        document.getElementById("saveBtn").style.display='block';
      }
    }
    $(document).ready(function () {
      if (screen.width <= 800){
        document.getElementById("autoSave").checked = false;
        document.getElementById("saveBtn").style.display='block';
      } else{
        document.getElementById("autoSave").checked = true;  
        document.getElementById("saveBtn").style.display="none";
      }
      $('#summernote').summernote({
        fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New', 'Baskerville', 'Gupter', 'Roboto Mono', 'Roboto Condensed', 'Source Sans Pro', 'Merriweather', 'Roboto Slab', 'Calistoga', 'Playfair Display'],
        fontNamesIgnoreCheck: ['Baskerville', 'Gupter', 'Roboto Mono', 'Roboto Condensed', 'Source Sans Pro', 'Merriweather', 'Roboto Slab', 'Calistoga', 'Playfair Display'],
        toolbar: [
          //['paragraph style', ['style', 'ol', 'ul', 'paragraph', 'height']],
          //['font style', ['fontname', 'fontsize', 'color', 'bold', 'underline', 'strikethrough', 'superscript', 'subscript', 'clear']],
          //['insert', ['picture', 'link', 'video', 'table', 'hr']],
          //['misc', ['fullscreen', 'codeview', 'help']]
          ['paragraph', ['style', 'fontname', 'fontsize']],
          ['biuc', ['bold', 'italic', 'underline', 'clear']],
          ['text', ['strikethrough', 'superscript', 'subscript', 'color']],
          ['lists', ['ol', 'ul']],
          ['paragraph2', ['paragraph', 'height']],
          ['insert', ['picture', 'link', 'video', 'table', 'hr']],
          ['misc', ['fullscreen', 'codeview', 'help']]
        ],
        lorem: {
          el: '#summernote', // Element ID or Class used to Initialise Summernote.
          html: true // Place Lorem Ipsum Paragraphs inside <p> or set to false to not too.
        }
      });
      $.ajax({
        url: '/writer/document/{{name}}',
        type: 'GET',
        success: function (res) {
          $('#summernote').summernote('code', res);
        }

      })
    });
    $('#summernote').on('summernote.change', function (we, contents, $editable) {
      console.log('onChange:', contents, $editable);
      we.preventDefault();
      var id_value = contents;
      // Do an AJAX post
      if (document.getElementById("autoSave").checked) {
        $.ajax({
          type: "POST",
          url: "/writer/save/{{name}}",
          data: {
            editordata: id_value // various ways to store the ID, you can choose
          },
          success: function (data) {
            // POST was successful - do something with the response

          },
          error: function (data) {
            // Server error, e.g. 404, 500, error
          }
        });
      }
    });

    $('div.note-emojionechar-dialog').attr('tabindex', '-1');
  </script>
</body>

</html>